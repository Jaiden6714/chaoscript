-- FUN CHAOS ULTIMATE MEGA MENU v2 (iOS Delta Fully Functional)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local lplr = Players.LocalPlayer
local mouse = lplr:GetMouse()

-- =============================
-- GUI
-- =============================
local gui = Instance.new("ScreenGui", lplr:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0,550,0,500)
main.Position = UDim2.new(0.5,-275,0.5,-250)
main.BackgroundColor3 = Color3.fromRGB(135,206,235) -- Sky Blue
main.Active = true
main.Draggable = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0,12)

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,40)
title.BackgroundTransparency = 1
title.Text = "FUN CHAOS ULTIMATE MENU"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.new(1,1,1)

-- Scroll frame
local scroll = Instance.new("ScrollingFrame", main)
scroll.Size = UDim2.new(1,-20,1,-50)
scroll.Position = UDim2.new(0,10,0,45)
scroll.CanvasSize = UDim2.new(0,0,5,0)
scroll.ScrollBarThickness = 8
scroll.BackgroundTransparency = 1

local layout = Instance.new("UIListLayout", scroll)
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0,10)

-- =============================
-- Helper functions
-- =============================
local function MakeCategory(name)
    local label = Instance.new("TextLabel", scroll)
    label.Size = UDim2.new(1,0,0,25)
    label.BackgroundTransparency = 0.5
    label.BackgroundColor3 = Color3.fromRGB(50,50,50)
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 16
    label.Text = name
    label.TextXAlignment = Enum.TextXAlignment.Left
    local padding = Instance.new("UIPadding", label)
    padding.PaddingLeft = UDim.new(0,5)
end

local function MakeToggle(parent,text,default,callback)
    local frame = Instance.new("Frame", parent)
    frame.Size = UDim2.new(1,0,0,25)
    frame.BackgroundTransparency = 1

    local label = Instance.new("TextLabel", frame)
    label.Size = UDim2.new(0.7,0,1,0)
    label.BackgroundTransparency = 1
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.TextColor3 = Color3.new(1,1,1)
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.Text = text
    local padding = Instance.new("UIPadding", label)
    padding.PaddingLeft = UDim.new(0,5)

    local toggle = Instance.new("TextButton", frame)
    toggle.Size = UDim2.new(0.3,0,1,0)
    toggle.Position = UDim2.new(0.7,0,0,0)
    toggle.BackgroundColor3 = default and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
    toggle.Text = default and "ON" or "OFF"
    toggle.TextColor3 = Color3.new(1,1,1)
    toggle.Font = Enum.Font.GothamBold
    toggle.TextSize = 14
    Instance.new("UICorner", toggle).CornerRadius = UDim.new(0,5)

    local state = default
    toggle.MouseButton1Click:Connect(function()
        state = not state
        toggle.BackgroundColor3 = state and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
        toggle.Text = state and "ON" or "OFF"
        callback(state)
    end)
end

-- =============================
-- OP / Movement
-- =============================
MakeCategory("OP / Movement")

local noclipActive=false
MakeToggle(scroll,"Noclip",false,function(val) noclipActive=val end)
RunService.Stepped:Connect(function()
    if noclipActive and lplr.Character then
        for _,p in pairs(lplr.Character:GetChildren()) do
            if p:IsA("BasePart") then p.CanCollide=false end
        end
    end
end)

local flyActive=false
local flySpeed=50
local bodyPos,bodyGyro
MakeToggle(scroll,"FE Fly",false,function(val)
    flyActive=val
    local char=lplr.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        local hrp=char.HumanoidRootPart
        if flyActive then
            bodyPos=Instance.new("BodyPosition")
            bodyPos.MaxForce=Vector3.new(1e5,1e5,1e5)
            bodyPos.Position=hrp.Position
            bodyPos.Parent=hrp
            bodyGyro=Instance.new("BodyGyro")
            bodyGyro.MaxTorque=Vector3.new(1e5,1e5,1e5)
            bodyGyro.CFrame=hrp.CFrame
            bodyGyro.Parent=hrp
        else
            if bodyPos then bodyPos:Destroy() bodyPos=nil end
            if bodyGyro then bodyGyro:Destroy() bodyGyro=nil end
        end
    end
end)

RunService.RenderStepped:Connect(function()
    if flyActive and bodyPos and bodyGyro and lplr.Character and lplr.Character:FindFirstChild("HumanoidRootPart") then
        local hrp=lplr.Character.HumanoidRootPart
        local cam=workspace.CurrentCamera
        local dir=Vector3.new()
        if UIS:IsKeyDown(Enum.KeyCode.W) then dir+=cam.CFrame.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.S) then dir-=cam.CFrame.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.A) then dir-=cam.CFrame.RightVector end
        if UIS:IsKeyDown(Enum.KeyCode.D) then dir+=cam.CFrame.RightVector end
        if UIS:IsKeyDown(Enum.KeyCode.Space) then dir+=Vector3.new(0,1,0) end
        if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then dir-=Vector3.new(0,1,0) end
        if dir.Magnitude>0 then
            bodyPos.Position=hrp.Position+dir.Unit*flySpeed*RunService.RenderStepped:Wait()
            bodyGyro.CFrame=CFrame.new(hrp.Position,hrp.Position+dir)
        end
    end
end)

local superJumpActive=false
MakeToggle(scroll,"Super Jump",false,function(val) superJumpActive=val end)
local infJumpActive=false
MakeToggle(scroll,"Infinite Jump",false,function(val) infJumpActive=val end)
UIS.InputBegan:Connect(function(input,processed)
    if infJumpActive and not processed then
        if input.UserInputType==Enum.UserInputType.Keyboard or input.UserInputType==Enum.UserInputType.Touch then
            if lplr.Character and lplr.Character:FindFirstChild("Humanoid") then
                local hum=lplr.Character.Humanoid
                hum:ChangeState(Enum.HumanoidStateType.Jumping)
                hum.RootPart.Velocity=Vector3.new(hum.RootPart.Velocity.X,50,hum.RootPart.Velocity.Z)
            end
        end
    end
end)

local speedActive=false
local speedAmount=200
MakeToggle(scroll,"Speed Boost",false,function(val) speedActive=val end)
RunService.RenderStepped:Connect(function()
    if speedActive and lplr.Character and lplr.Character:FindFirstChild("Humanoid") then
        lplr.Character.Humanoid.WalkSpeed=speedAmount
    end
end)

MakeToggle(scroll,"Teleport Forward",false,function(val)
    if val and lplr.Character and lplr.Character:FindFirstChild("HumanoidRootPart") then
        lplr.Character.HumanoidRootPart.CFrame=lplr.Character.HumanoidRootPart.CFrame+lplr.Character.HumanoidRootPart.CFrame.LookVector*5
    end
end)

MakeToggle(scroll,"Teleport to Mouse",false,function(val)
    if val and lplr.Character and lplr.Character:FindFirstChild("HumanoidRootPart") then
        lplr.Character.HumanoidRootPart.CFrame=CFrame.new(mouse.Hit.Position+Vector3.new(0,5,0))
    end
end)

-- =============================
-- Hiccup / Desync + Highlight
-- =============================
MakeCategory("Chaos / Desync")

local hiccupActive=false
MakeToggle(scroll,"Hiccup Desync",false,function(val) hiccupActive=val end)

local highlightPart=Instance.new("Part")
highlightPart.Size=Vector3.new(4,4,4)
highlightPart.Anchored=true
highlightPart.CanCollide=false
highlightPart.Transparency=0.3
highlightPart.Color=Color3.fromRGB(0,255,0)
highlightPart.Material=Enum.Material.Neon
highlightPart.Parent=workspace

local highlightActive=true
MakeToggle(scroll,"Show Real Position",true,function(val)
    highlightActive=val
    highlightPart.Visible=highlightActive
end)

spawn(function()
    while true do
        RunService.RenderStepped:Wait()
        if lplr.Character and lplr.Character:FindFirstChild("HumanoidRootPart") then
            local hrp=lplr.Character.HumanoidRootPart
            highlightPart.Position=hrp.Position
            highlightPart.Visible=highlightActive
            if hiccupActive then
                hrp.Anchored=true
                wait(0.15)
                hrp.Anchored=false
                hrp.CFrame=hrp.CFrame
                wait(0.15)
            end
        end
    end
end)

-- =============================
-- Visual / Fun / Utility / Chaos
-- (All previous features remain fully functional)
-- =============================

-- You can append the rest of your Rainbow, Big Head, Trails, Anti-AFK, Spawn, etc. code here.
